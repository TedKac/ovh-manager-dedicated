<div>

    <div data-ovh-alert></div>

    <h2 data-translate="payments_title"></h2>

    <div data-ui-view>
        <p class="alert alert-info"
           role="alert"
           data-translate="payments_description">
        </p>

        <div class="mb-4"
             data-ng-if="ctrl.paymentRequests.length">
            <oui-message data-type="info">
                <span data-ng-bind-html="tr('payments_request_pending', [ctrl.paymentRequestsHref])"></span>
            </oui-message>
        </div>

        <div class="row">
            <div class="col-md-6">
                <button type="button"
                        class="btn btn-default mb-2"
                        data-export-csv="ctrl.getDatasToExport()"
                        data-export-csv-separator=";"
                        data-ng-disabled="ctrl.payments.length === 0">
                        <span data-translate="billing_export_csv"></span>
                </button>
            </div>
            <div class="col-md-6">
                <div class="text-right"
                     data-billing-date-range
                     data-on-change="ctrl.onDateRangeChanged">
                </div>
            </div>
        </div>

        <oui-datagrid data-rows-loader="ctrl.loadPayments($config)">
            <oui-column data-title=":: 'payments_table_head_id' | translate"
                        data-property="depositId">
            </oui-column>
            <oui-column data-title=":: 'payments_table_head_date' | translate">
                <span data-ng-bind="$row.date | date:'mediumDate'"></span>
            </oui-column>
            <oui-column data-title=":: 'payments_table_head_amount' | translate">
                <span data-ng-bind="$row.amount.text"></span>
            </oui-column>
            <oui-column data-title=":: 'payments_table_head_type' | translate">
                <span data-ng-bind=":: ctrl.getTranslatedPaiementType($row)"></span>
            </oui-column>
            <oui-action-menu data-align="end"
                             data-compact>
                <oui-action-menu-item data-text="{{:: 'table_download_html' | translate }}"
                                      data-href="{{ $row.htmlUrl || $row.url }}"
                                      data-ng-if="($row.url || $row.htmlUrl) && ctrl.shouldDisplayDepositsLinks()"
                                      data-external>
                </oui-action-menu-item>
                <oui-action-menu-item data-text="{{:: 'table_download_pdf' | translate }}"
                                      data-href="{{ :: $row.pdfUrl }}"
                                      data-ng-if="$row.pdfUrl && ctrl.shouldDisplayDepositsLinks()"
                                      data-external>
                </oui-action-menu-item>
                <oui-action-menu-item data-text="{{:: 'payments_details_link' | translate }}"
                                      data-href="#/billing/payments/{{ :: $row.depositId }}/details">
                </oui-action-menu-item>
            </oui-action-menu>
        </oui-datagrid>
    </div>
</div>
